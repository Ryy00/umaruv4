const e=require("../utils"),r=require("npmlog");module.exports=function(t,n,i){return function(n,a,o){if("Function"==e.getType(a)&&(o=a,a=null),"Array"!==e.getType(n))throw{error:"createNewGroup: participantIDs should be an array."};if(n.length<2)throw{error:"createNewGroup: participantIDs should have at least 2 IDs."};let u=function(){},s=function(){};const c=new Promise((function(e,r){u=e,s=r}));o||(o=function(e,r){if(e)return s(e);u(r)});const p=[];for(const e in n)p.push({fbid:n[e]});p.push({fbid:i.i_userID||i.userID});const _={fb_api_caller_class:"RelayModern",fb_api_req_friendly_name:"MessengerGroupCreateMutation",av:i.i_userID||i.userID,doc_id:"577041672419534",variables:JSON.stringify({input:{entry_point:"jewel_new_group",actor_id:i.i_userID||i.userID,participants:p,client_mutation_id:Math.round(1024*Math.random()).toString(),thread_settings:{name:a,joinable_mode:"PRIVATE",thread_image_fbid:null}}})};return t.post("https://www.facebook.com/api/graphql/",i.jar,_).then(e.parseAndCheckLogin(i,t)).then((function(e){if(e.errors)throw e;return o(null,e.data.messenger_group_thread_create.thread.thread_key.thread_fbid)})).catch((function(e){return r.error("createNewGroup",e),o(e)})),c}};